#### TurboShortcuts for GoogleChrome

###### [使い方](#usage)／[注意事項](#notes)／[Utility Object Reference](#utilobj)
> 

###### はじめに

> この度は本ソフトをダウンロードいただきありがとうございます。  
> 
> 本ソフトは、GoogleChromeの主にショートカットキーの機能を拡張するもので、以下の特徴・機能があります。

###### Features

> **ショートカットキーの再割り当て機能**
>
> > 既存のショートカットキーの組み合わせを無効にして、別のショートカットキーを割り当てることができます。  
> > ショートカットキーに、ファンクションキーやマウスイベントを割り当てることもできます。  

> **ブックマークの割り当て・サーチ機能**
> 
> > ショートカットキーにブックマークを割り当てられます。  
> > 既に開いている場合はタブを検索してアクティブにできます。

> **拡張コマンド機能**
>
> > 次のコマンドをショートカットキーに割り当てることができます。  
> > 
> > 1. 主にタブ周りの機能で、タブの移動やコピー、削除、固定、切り離し、Window選択等  
> > 2. 定型文クリップボード貼り付け機能  
> > 3. CSS挿入機能  
> > 4. JavaScript実行  
> > 
> > JavaScript実行機能では、ユーティリティオブジェクトを利用して、ショートカットキーを操作することができます。

<a name="usage"></a>
###### オプションページの基本操作
> - **ショートカットキーの登録**
> 
>    1. AddNewボタンをクリックしてからショートカットキーを押下するか、直接ショートカットキーを押下して  
>       新しく割り当てるショートカットキー（New）を登録します。  
> 
>       ・ファンクションキーは単独でショートカットキーになります。  
>
>       ・マウスイベントは次の組み合わせが登録できます。  
>       　Ctrl|Alt|Shift|Winキー + マウスクリック（左or右or中クリック）  
>       　Ctrl|Alt|Shift|Winキー + マウスホイール  
>       　マウスクリック（左or右or中クリック） + マウスホイール  
>
>       ・既に登録済みのショートカットキーは登録できません。
> 
>    2. 自動的に、変更したいショートカットキー（Origin）にフォーカスされるので、ショートカットキーを押下しOriginを登録します。  
>
>       OriginのショートカットキーにChromeのショートカット機能が割り当てられている場合は、Descriptionに説明が表示されます。

> - **機能（Mode）の変更**
>
>    初期登録時は、Mode列に<i class="icon-random"></i>(Remap)が表示されています。  
>    マウスカーソルをあわせるとアイコン<i class="icon-caret-down"></i>が表示されるので、クリックするとメニューが表示されます。
>    以下のメニューがあります。
> >
> >    <i class="icon-random"></i>**Remap** ..................... ショートカットキーを別のショートカットキーに割り当てます。  
> > 
> >    <i class="icon-cog"></i>**Command** .............. 拡張コマンドをショートカットキーに割り当てます。 追加オプションが必要な場合、[オプション](#commandOptions)入力ダイアログが開きます。  
> > 
> >    <i class="icon-bookmark"></i>**Bookmark** .............. ブックマークをショートカットキーに割り当てます。 ブックマークの[オプション](#bookmarkOptions)入力ダイアログが開きます。  
> > 
> >    <i class="icon-font"></i>**DOM Key Event** ..... ページスクリプトを実行してDOMのキーイベント(keyIdentifier)を発生させます。
> > 
> >    <i class="icon-ban-circle"></i>**Disabled** .................. ショートカットキーを無効にして使用不可にします。  
> 
>    なお、Modeを変更すると、拡張コマンドやブックマークに設定していたオプションは消去されるので、ご注意ください。

> - **ショートカットキーの変更**
>
>    割り当てるショートカットキー(New)、変更したいショートカットキー(Origin)のどちらも、フォーカスをあわせてショートカットキーを押下すれば変更できます。
>
>    Originは重複可能ですが、Newは登録済みのショートカットキーには変更できません。

> 以下は、各行の右端に表示されるアイコンボタン[<i class="icon-caret-down"></i>]クリック時のメニューで選択します。  
> メニューは、Modeにより一部内容が異なります。
> 
> - **ショートカットキーの削除**  
>    「Delete」を選択します。 復帰はできませんので、ご注意ください。
> - **ショートカットキーの一時停止**  
>    「Pause」を選択します。 一時的にショートカットキーの割り当てを停止します。 次回メニューの「Resume」を選択して復帰させることができます。
> - **拡張コマンドの編集**  
>    「Edit Command」を選択します。 編集可能な拡張コマンド選択時のみ選択できます。
> - **ブックマークの編集**  
>    「Edit Bookmark」を選択します。 ブックマークのときに選択できます。
> - **Descriptionの編集（メモ機能）**  
>    「Edit Description」を選択します。 Remap/Simurate key event/Disabledモード時に、Descriptionが空欄のときに選択できます。  
>    メモ的な用途で利用します。
> - **JavaScriptショートカットキー操作コマンドのコピー**  
>    「Copy shortcut command」を選択します。  
>    拡張コマンドのExecute Scriptで使用するショートカットキー実行コマンドが、クリップボードにコピーされます。
> 

<a name="bookmarkOptions"></a>
###### ブックマークのオプション
> ブックマークを選択すると、オプション入力ダイアログが開きます。
> 
> - ブックマークを開くオプション  
>    - **Open in current tab** .................. 現在のタブにブックマークを開きます。  
>    - **Open in new tab** ......................... 新しいタブにブックマークを開きます。  
>    - **Open in new window** ................ 新しいウィンドウにブックマークを開きます。  
>    - **Open in incognito window** ..... 新しいシークレットウィンドウにブックマークを開きます。 
>    - **Only to find the tab** ................... 開いているタブからブックマークを検索しますが、新しいブックマークは開きません。 
> - ブックマークを検索するオプション
>    - **Activate the tab if already open**  
>        チェック時、開いているタブから**タイトル**または**URL**を検索して、見つかった場合はそのタブをアクティブにします。  
>    - **Title or URL to find (Intermediate matching)**  
>        検索するタブの**タイトル**または**URL**を入力します。 中間マッチで検索されます。

<a name="commandOptions"></a>
###### 拡張コマンドのオプション
> 拡張コマンド（Command mode）に追加オプションが必要な場合は、オプション入力ダイアログが開きます。
> 
> - Paste text、InsertCSS、Execute scriptのオプション
>    - **Title(Optional)**  
>    オプションページのDescriptionに表示されます。 未入力の場合は、Contentに入力した1行目がセットされます。
>    - **Content**  
>    定型文字列(Paste text時)やCSS(Insert CSS時)、JavaScript(Execute script時)を入力します。  
> - InsertCSS、Execute scriptのオプション
>    - **All frames**  
>    チェック時は、ページのすべてのフレームに、CSSやJavaScriptが適用されます。  
>    未チェック時はトップフレームにのみ適用されます。
> - Execute scriptのオプション
>    - **Use Utility Object**  
>    チェック時に、JavaScriptからショートカットキーを操作できるObjectが利用できます。  
>    詳細は[Utility Object Reference](#utilobj)を参照してください。
>

<a name="notes"></a>
###### 備考・注意事項
> - 設定の保存は自動的に行われます。 特に保存ボタンなどはありません。  
>
>    タブまたはウィンドウの切り替え時に保存され、設定はすぐに反映されます。  
> - 登録できるショートカット数は、最大50個までです。
> - Alt+Tab、Ctrl+Esc、Win+EなどのWindowsショートカットキーは利用できません。  
> - ブックマーク、定型文貼り付け、CSS挿入、JavaScript実行機能ではキーリピートは効きません。  
> 
>    定型文貼り付けでは、クリップボードにテキストが残っているので  
>    キーリピートさせたい場合は、Ctrl+V(または相当のショートカットキー)に切り替えてください。
> - Simurate key event(DOMのキーイベント生成機能)では、イベントからkeyCodeは取得できません。  
>    keyIdentifierのみ発生させることができます。
> - マウスホイールイベントでホイール高分解能マウスは未検証です。
> 

<a name="utilobj"></a>
###### Utility Object Reference

> **Methods**
> 
> ###### `tsc.send(string keycode[, optional integer sleepMillisecond])`  
> > 
> > ショートカットキーを呼び出します。  
> > リマップ定義済みのショートカットキーはリマップされます。  
> > 自己参照・循環参照がある場合は無限ループになってしまう為、注意してください。
> > 
> > - _keycode(string)_  
> > 
> >    書式: [_modifierkeys_]_keyIdentifier_    
> > 
> >    _modifierkeys_は**C**trl,**A**lt,**S**hift,**W**inキーの頭文字の組み合わせを指定します。  
> >    単独のファンクションキーのときは角括弧を省略できます。
> > 
> >    _keyIdentifier_はキートップに刻印されている文字をそのまま指定します。  
> >    この際、Shiftキーが含まれるときでも、大文字や上段シフトの文字を指定する必要はありません。    
> >    特殊キーについては、ショートカットキー登録時の値を参照してください。大文字小文字を区別します。  
> > 
> > - _sleepMillisecond(integer default 100)_  
> > 
> >    メソッド実行後の、次のtscオブジェクトメソッドが実行されるまでの間隔を、ミリ秒単位で指定します。  
> >    値の範囲は、0-60000(60秒)までで、値を指定しない場合の規定値は100ミリ秒です。  
> >    なお、通常のJavaScriptコマンドには影響しません。  
> > 
> > Code Exsample  
> > 
> > 次のコードは、テキストを選択した状態で検索バーを開いたときに、選択テキストを入力済で開きます。
> > <pre>
> > tsc.send('[c]c'); /* Ctrl+c ハイライト表示されたコンテンツをクリップボードにコピーします。 */
> > tsc.send('F3');   /* F3 検索バーに入力したキーワードとの次の一致箇所を表示します。 */
> > tsc.send('[c]f'); /* Ctrl+f 検索バーを開きます。 */
> > </pre>
> > 
> > 次のコードは、ページのソースを開いてコピーして、開いたソースのページを閉じます。
> > <pre>
> > tsc.send('[c]u', 1000); /* Ctrl+u 現在のページのソースを開きます。 */
> > tsc.send('[c]a');
> > tsc.send('[c]c');       /* Ctrl+c ハイライト表示されたコンテンツをクリップボードにコピーします。 */
> > tsc.send('[c]w');       /* Ctrl+w 現在のタブまたはポップアップを閉じます。 */
> > </pre>

> ###### `tsc.keydown(string keycode[, optional integer sleepMillisecond])`  
> > 
> > 指定したキーを押下します。単独キーも指定できます。  
> > ショートカットキーを指定した場合は、リマップ済みのショートカットキーでもリマップされません。
> > 
> > - _keycode(string)_  
> > 
> >    書式は_send_メソッドと同じですが、単独キーの場合、角括弧は必要ありません。

> ###### `tsc.sleep(integer sleepMillisecond)`  
> > 
> > 指定したミリ秒間スリープして、次のtscオブジェクトメソッドの実行開始を遅らせます。  
> > なお、通常のJavaScriptコマンドには影響しません。

> ###### `tsc.clipbd(string text)`  
> > 
> > 文字列をクリップボードに貼付けます。

> ###### `tsc.send(...).done(function callback)`  
> ###### `tsc.keydown(...).done(function callback)`
> ###### `tsc.sleep(...).done(function callback)`
> ###### `tsc.clipbd(...).done(function callback)`
> >  
> > 各tscオブジェクトメソッドの呼び出しを終了してから、登録したファンクションを実行します。  
> > スリープを指定していた場合は、スリープ時間経過後に実行されます。
> > 
> > tscオブジェクトメソッド間は自動的に同期されるため、このメソッドは必要ありません。
> > 
> > Code Exsample  
> > 
> > <pre>
> > tsc.sleep(5000).done(function() { alert('5秒経過'); });
> > </pre>
