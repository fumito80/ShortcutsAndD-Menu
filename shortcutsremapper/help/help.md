#### TurboShortcuts for GoogleChrome

###### [使い方](#usage)／[注意事項](#notes)／[Utility Object Reference](#utilobj)
> 

###### はじめに

> この度は本ソフトをダウンロードいただきありがとうございます。  
> 
> 本ソフトは、GoogleChromeの主にキーボードショートカットの機能を拡張するもので、以下の特徴・機能があります。

###### Features

> **ショートカットキーの再割り当て機能**
>
> > Chromeが標準で備えているショートカットキーのキーアサインを  
> > 別のショートカットキーに割り当てたり、無効にすることができます。  
> > また、ファンクションキーやマウスイベントを割り当てることもできます。  

> **ブックマークの割り当て・サーチ機能**
> 
> > ショートカットキーにブックマークを割り当てられます。  
> > 既に開いている場合はタブを検索してアクティブにできます。

> **拡張コマンド機能**
>
> > 次のコマンドをショートカットキーに割り当てて、ショートカットキーの機能を拡張することができます。  
> > 
> > 1. 主にタブ周りの機能で、タブの移動やコピー、削除、固定、切り離し、Window選択等  
> > 2. 定型文クリップボード貼り付け機能  
> > 3. CSS挿入機能  
> > 4. JavaScript実行  
> > 
> > JavaScript実行機能では、ユーティリティオブジェクトを利用して、キー入力を操作することができます。

<a name="usage"></a>
###### オプションページの基本操作
> - **キーボードタイプの変更**  
>
>    お使いのキーボードに合わせて、画面右上のキーボード選択ドロップダウンリストから  
>    109日本語キーボードか、104英語キーボードのどちらかを選択します。  
> 
> - **ショートカットキーの登録**
> 
>  1. AddNewボタンをクリックしてからショートカットキーを押下するか、直接ショートカットキーを押下して  
>     新しく割り当てるショートカットキー（New）を登録します。  
> > 
> >    - ファンクションキーは単独でショートカットキーになります。  
> >    - マウスイベントは次の組み合わせが登録できます。  
> > 
> >        Ctrl|Alt|Shift|Winキー + マウスクリック（左or右or中クリック）  
> >        Ctrl|Alt|Shift|Winキー + マウスホイール  
> >        マウスクリック（左or右or中クリック） + マウスホイール  
> >    - 既に登録済みのショートカットキーは登録できません。  
>
>  2. 自動的に、変更したいショートカットキー（Origin）にフォーカスされるので  
>     ショートカットキーを押下しOriginを登録します。  
>
>       OriginのショートカットキーにChromeのショートカット機能が割り当てられている場合は、Descriptionに説明が表示されます。

> - **機能（Mode）の変更**
>
>    初期登録時は、Mode列に<i class="icon-random"></i>(Remap)が表示されています。  
>    マウスカーソルをあわせるとアイコン<i class="icon-caret-down"></i>が表示されるので、クリックするとメニューが表示されます。
>    以下のメニューがあります。
> >
> >    <i class="icon-random"></i>**Remap** ..................... ショートカットキーを別のショートカットキーに割り当てます。  
> > 
> >    <i class="icon-cog"></i>**Command** .............. 拡張コマンドをショートカットキーに割り当てます。   
> > 　　　　　　　　　　　　　　　[コマンド選択](#command)ダイアログが開き、続けて、追加オプションが必要な場合、<wbr>[オプション](#commandOptions)入力ダイアログが開きます。  
> > 
> >    <i class="icon-bookmark"></i>**Bookmark** .............. ブックマークをショートカットキーに割り当てます。  
> > 　　　　　　　　　　　　　　　ブックマーク選択ダイアログが開き、続けて[オプション](#bookmarkOptions)入力ダイアログが開きます。  
> > 
> >    <i class="icon-font"></i>**DOM Key Event** ..... ページスクリプトを実行してDOMのキーイベント(keyIdentifier)を発生させます。
> > 
> >    <i class="icon-ban-circle"></i>**Disabled** .................. ショートカットキーを無効にして使用不可にします。  
> 
>    なお、Modeを変更すると、拡張コマンドやブックマークに設定していたオプションは消去されるので、ご注意ください。

> - **ショートカットキーの変更**
>
>    割り当てるショートカットキー(New)、変更したいショートカットキー(Origin)のどちらも、フォーカスをあわせてショートカットキーを押下すれば変更できます。
>
>    Originは重複可ですが、Newは登録済みのショートカットキーには変更できません。

> 以下は、各行の右端に表示されるアイコンボタン[<i class="icon-caret-down"></i>]クリック時のメニューから選択します。  
> メニュー項目は、Modeにより一部内容が異なります。
> 
> - **ショートカットキーの削除**  
>    「Delete」を選択します。 復帰はできませんので、ご注意ください。
> - **ショートカットキーの一時停止**  
>    「Pause」を選択します。 一時的にショートカットキーの割り当てを停止します。 次回メニューの「Resume」を選択して復帰させることができます。
> - **拡張コマンドの編集**  
>    「Edit Command」を選択します。 編集可能な拡張コマンド選択時のみ選択できます。
> - **ブックマークの編集**  
>    「Edit Bookmark」を選択します。 ブックマークのときに選択できます。
> - **Descriptionの編集（メモ機能）**  
>    「Edit Description」を選択します。 Remap/DOM Key Event/Disabledモード時に、Descriptionが空欄のときに選択できます。  
>    メモ的な用途で利用します。
> - **JavaScriptショートカットキー操作コマンドのコピー**  
>    「Copy send method」または「Copy keydown method」を選択します。  
>    拡張コマンドのExecute Scriptで使用する[ショートカットキー操作コマンド](#utilobj)が、クリップボードにコピーされます。
> 

<a name="command"></a>
###### 拡張コマンド一覧
> > 
> - Tab commands  
>    - **Close other tabs**  
>        アクティブなタブ以外の、現在のウィンドウ内のタブを、すべて閉じます。  
>    - **Close tabs to the left/right**  
>        アクティブなタブの左側もしくは右側のタブを、すべて閉じます。
>    - **Move current tab left/right**  
>        アクティブなタブを、左もしくは右へ一つ移動します。 最端位置から循環はしません。
>    - **Move current tab to first/last position**  
>        アクティブなタブを、左端(first)もしくは右端(last)へ移動します。
>    - **Duplicate a current tab**  
>        アクティブなタブを複製して、タブの右側に新たに作成します。
>    - **Duplicate a current tab to a new window**  
>        アクティブなタブを複製して、新しいウィンドウに新たに作成します。
>    - **Pin/Unpin a current tab**  
>        アクティブなタブを、固定するか、もしくは固定されいている場合は固定を解除します。
>    - **Detaches a current tab**  
>        アクティブなタブを、ウィンドウから切り離して、新しいウィンドウに作成します。
>    - **Attaches a current tab to the next window**  
>        アクティブなタブを、現在開いている別のウィンドウに順次移動します。
> - Window commands  
>    - **Switches to the previous/next window**  
>        アクティブなウィンドウを順次切り替えます。
>    - **Close other windows**  
>        アクティブなウィンドウ以外のすべてのウィンドウを閉じます。
> - Other  
>    - **Paste text**  
>        登録した定型文を、クリップボードを経由して貼り付けます。  
>    - **Insert CSS**  
>        登録したCSS(Cascading Style Sheet)を、アクティブなタブのページへ適用（追加）します。  
>    - **Execute script**  
>        登録したJavaScriptコードを、アクティブなタブのページで実行します。   
>        なお、本来のページのDOMのwindowオブジェクトにはアクセスできません。

<a name="commandOptions"></a>
###### 拡張コマンドのオプション
> 拡張コマンド（Command mode）に追加オプションが必要な場合は、オプション入力ダイアログが開きます。
> 
> - Paste text、InsertCSS、Execute scriptのオプション
>    - **Title(Optional)**  
>    オプションページのDescriptionに表示されます。 未入力の場合は、Contentに入力した1行目がセットされます。
>    - **Content**  
>    定型文字列(Paste text時)やCSS(Insert CSS時)、JavaScript(Execute script時)を入力します。  
> - InsertCSS、Execute scriptのオプション
>    - **All frames**  
>    チェック時は、ページのすべてのフレームに、CSSやJavaScriptが適用されます。  
>    未チェック時はトップフレームにのみ適用されます。
> - Execute scriptのオプション
>    - **Use Utility Object**  
>    チェック時に、JavaScriptからショートカットキーを操作できるObjectが利用できます。  
>    詳細は[Utility Object Reference](#utilobj)を参照してください。
>

<a name="bookmarkOptions"></a>
###### ブックマークのオプション
> ブックマークを選択すると、オプション入力ダイアログが開きます。
> 
> - ブックマークを開くオプション  
>    - **Open in current tab** .................. 現在のタブにブックマークを開きます。  
>    - **Open in new tab** ......................... 新しいタブにブックマークを開きます。  
>    - **Open in new window** ................ 新しいウィンドウにブックマークを開きます。  
>    - **Open in incognito window** ..... 新しいシークレットウィンドウにブックマークを開きます。 
>    - **Only to find the tab** ................... 開いているタブからブックマークを検索しますが、新しいブックマークは開きません。 
> - ブックマークを検索するオプション
>    - **Activate the tab if already open**  
>        チェック時、開いているタブからブックマークを検索して、見つかった場合はそのタブをアクティブにします。  
>        複数見つかった場合は、順次アクティブになります。
>    - **Title or URL to find (Intermediate matching)**  
>        検索するブックマークの**URL**または**タブのタイトル**を入力します。 中間マッチで検索されます。

<a name="notes"></a>
###### 備考・注意事項
> - オプションページの設定の保存は自動的に行われます。 特に保存ボタン等はありません。  
>    （タブまたはウィンドウの切り替え時に保存が実行され、設定はすぐに反映されます）
> - オプションページは各行をドラッグして並び順を変更できます。  
>    なお、行が多く、スクロールバーが表示されている状態のとき、ドラッグ中にスクロールされないときがありますが  
>    そのときはタイトルや周りの余白をクリックしてから再度試みてください。  
> - 登録できるショートカット数は、最大50個までです。
> - Alt+Tab、Ctrl+Esc、Win+EなどのWindowsショートカットキーは利用できません。
> - ブックマーク、定型文貼り付け、CSS挿入、JavaScript実行機能ではキーリピートは効きません。  
> 
>    定型文貼り付けでは、クリップボードにテキストが残っているので  
>    キーリピートさせたい場合は、Ctrl+V(または相当のショートカットキー)に切り替えてください。
> - DOM Key Event(DOMのキーイベント生成機能)では、イベントからkeyCodeは取得できません。  
>    keyIdentifierのみ発生させることができます。
> - 他のChrome拡張と同じく、Chrome設定関連のページやローカルファイルページでは、本拡張は無効になります。（単純なリマップは有効です）
> - マウスホイールイベントでホイール高分解能マウスは未検証です。
> 

<a name="utilobj"></a>
###### Utility Object Reference

> **Methods**
> 
> ###### `tsc.send(string keycode[, optional integer sleepMillisecond])`  
> > 
> > ショートカットキーを呼び出します。  
> > リマップや拡張コマンド、ブックマーク、DOM KeyEventを定義済みのショートカットキーはそれらが呼び出されます。  
> > 自己参照、循環参照がある場合は無限ループになってしまう為、注意してください。
> > 
> > - _keycode(string)_  
> > 
> >    書式: [_modifierkeys_]_keyIdentifier_    
> > 
> >    _modifierkeys_は**C**trl,**A**lt,**S**hift,**W**inキーの頭文字の組み合わせを指定します。  
> >    単独のファンクションキーのときは角括弧を省略できます。
> > 
> >    _keyIdentifier_はキートップに刻印されている文字をそのまま指定します。  
> >    この際、Shiftキーが含まれるときでも、大文字や上段シフトの文字を指定する必要はありません。（どちらでも構いません）  
> >    特殊キーについては、ショートカットキー登録時の値を参照してください。 大文字小文字を区別します。  
> > 
> >    ショートカットキー以外の単独キーは無視されます。  
> > 
> > - _sleepMillisecond(integer default 100)_  
> > 
> >    メソッド実行後の、次のtscオブジェクトメソッドが実行されるまでの間隔を、ミリ秒単位で指定します。  
> >    値の範囲は、0-60000(60秒)までで、値を指定しない場合の規定値は100ミリ秒です。  
> >    なお、通常のJavaScriptコマンドには影響しません。  
> > 
> > Code Exsample  
> > 
> > 次のコードは、ページのソースを開いてコピーして、開いたソースのページを閉じます。
> > <pre>
> > tsc.send('[c]u', 1000); /* Ctrl+u 現在のページのソースを開きます。実際のページが表示されるまでの猶予を1秒見ています。 */
> > tsc.send('[c]a');       /* Ctrl+a */
> > tsc.send('[c]c');       /* Ctrl+c ハイライト表示されたコンテンツをクリップボードにコピーします。 */
> > tsc.send('[c]w');       /* Ctrl+w 現在のタブまたはポップアップを閉じます。 */
> > </pre>
> > 
> > 次のコードは、新しいタブを一番左側に開きます。
> > <pre>
> > tsc.send('[c]t');  /* Ctrl+t 新しいタブを開きます。 */
> > tsc.send('[cs]1'); /* カレントタブを左端に移動するコマンドを割り当てたショートカットキーを呼び出し */
> > </pre>

> ###### `tsc.keydown(string keycode[, optional integer sleepMillisecond])`  
> > 
> > 指定したキーを押下します。単独キーも指定できます。  
> > ショートカットキーを指定した場合は、リマップ等定義済みのショートカットキーでもそれらは呼び出されず、単にキー押下が実行されます。
> > 
> >    引数の書式は_send_メソッドと同じです。
> > 
> > Code Exsample  
> > 
> > 次のコードは、ウィンドウを閉じるときに確認してから閉じます。  
> > Ctrl+Shift+W（Chrome標準のウィンドウを閉じるショートカットキー）に割り当てた場合を想定しています。
> > <pre>
> > if (confirm('ウィンドウを閉じますか？')) {
> >   tsc.keydown('[cs]w'); /* sendメソッドでは自己参照になってしまう為、keydownメソッドを使用 */
> > }
> > </pre>
> > 
> > 次のコードは、テキストを選択した状態で検索バーを開いたときに、選択テキストを入力済で開きます。
> > <pre>
> > tsc.keydown('[c]c'); /* Ctrl+c ハイライト表示されたコンテンツをクリップボードにコピーします。 */
> > tsc.keydown('[c]f'); /* Ctrl+f 検索バーを開きます。 */
> > tsc.keydown('[c]v'); /* Ctrl+v クリップボードからコンテンツを貼り付けます。 */
> > /* なお、このコードでは、クリップボードの文字が毎回必ずセットされてしまうので注意 */
> > </pre>
> > 
> > 次のコードは、選択したテキストをGoogleで検索します。
> > <pre>
> > tsc.keydown('[c]c');
> > tsc.send('[cs]g', 1000); /* Googleを開く定義済みブックマークショートカット */
> > tsc.keydown('[c]v');
> > tsc.keydown('Enter');
> > </pre>
> > 
> > 次のコードは、ブックマークバーを開き、更にその他のブックマークフォルダを開きます。
> > <pre>
> > tsc.keydown('[cs]b'); /* Ctrl+Shift+b ブックマーク バーの表示/非表示を切り替えます。 */
> > tsc.keydown('F6');    /* F6 キーボードからアクセス可能な次のペインにフォーカスが移動します。 */
> > tsc.keydown('F6');    /* F6 キーボードからアクセス可能な次のペインにフォーカスが移動します。 */
> > tsc.keydown('Left');
> > tsc.keydown('Down');
> > </pre>

> ###### `tsc.sleep(integer sleepMillisecond)`  
> > 
> > 指定したミリ秒間スリープして、次のtscオブジェクトメソッドの実行開始を遅らせます。  
> > なお、通常のJavaScriptコマンドには影響しません。

> ###### `tsc.clipbd(string text)`  
> > 
> > 文字列をクリップボードに貼付けます。

> ###### `tsc.send(...).done(function callback)`  
> ###### `tsc.keydown(...).done(function callback)`
> ###### `tsc.sleep(...).done(function callback)`
> ###### `tsc.clipbd(...).done(function callback)`
> >  
> > 各tscオブジェクトメソッドの呼び出しを終了してから、登録したファンクションを実行します。  
> > スリープを指定していた場合は、スリープ時間経過後に実行されます。
> > 
> > tscオブジェクトメソッド間は自動的に同期されるため、このメソッドは必要ありません。
> > 
> > Code Exsample  
> > 
> > <pre>
> > tsc.sleep(5000).done(function() { alert('5秒経過'); });
> > </pre>

> ###### `tsc.getClipbd().done(function callback(string text))`  
> >  
> > クリップボードにあるテキストを取得します。
> > 
> > 取得するテキストは、_done_メソッドに登録したコールバックファンクションに渡される引数から取得する必要があります。
> > 
> > Code Exsample  
> > 
> > <pre>
> > tsc.getClipbd().done(function(text) { alert(text); });
> > </pre>
